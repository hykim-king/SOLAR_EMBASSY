<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <!--<link rel="stylesheet" th:href="@{/css/board.css}"/>-->
    <link rel="stylesheet" href="/css/index.css">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
            crossorigin="anonymous"></script>
    <!--원본 css-->
    <link rel="stylesheet" href="/css/index.css">

    <!-- include libraries(jQuery, bootstrap) -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <!-- include summernote css/js -->
    <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
    <title>Insert title here</title>
    <style>
        html {
            overflow: scroll;
        }

        html, body, div, h1, h2, a, form, table, caption, submit {
            margin: 0;
            outline: 0;
            border: 0;
            padding: 0;
            font-size: 100%;
            vertical-align: baseline;
            background: transparent;
        }

        body {
            font-size: 0.875em;
            line-height: 1.5;
            color: #666;
            -webkit-text-size-adjust: none;
            min-width: 320px;
            font-family: 'NanumGothic', '나눔고딕', dotum, "Helvetica Neue", Helvetica, Verdana, Arial, Sans-Serief;
        }

        h1, h2, h3 {
            font-size: 1.5em;
        }

        p {
            margin: 0;
            padding: 0;
        }

        ul {
            margin: 0;
        }

        input {
            vertical-align: middle;
        }

        input:focus {
            outline: 0;
        }

        caption {
            display: none;
            width: 0;
            height: 0;
            margin-top: -1px;
            overflow: hidden;
            visibility: hidden;
            font-size: 0;
            line-height: 0;
        }

        .container {
            max-width: 1024px;
            margin: 30px auto;
        }

        .board_list {
            width: 100%;
            border-top: 2px solid #252525;
            border-bottom: 1px solid #ccc;
            margin: 15px 0;
            border-collapse: collapse;
        }

        .board_list thead th:first-child {
            background-image: none;
        }

        .board_list thead th {
            border-bottom: 1px solid #ccc;
            padding: 13px 0;
            color: #3b3a3a;
            text-align: center;
            vertical-align: middle;
        }

        .board_list tbody td {
            border-top: 1px solid #ccc;
            padding: 13px 0;
            text-align: center;
            vertical-align: middle;
        }

        .board_list tbody tr:first-child td {
            border: none;
        }

        .board_list tbody tr:hover {
            background: #ffff99;
        }

        .board_list tbody td.title {
            text-align: left;
            padding-left: 20px;
        }

        .board_list tbody td a {
            display: inline-block
        }

        .board_detail {
            width: 100%;
            border-top: 2px solid #252525;
            border-bottom: 1px solid #ccc;
            border-collapse: collapse;
        }

        .board_detail tbody input {
            width: 100%;
        }

        .board_detail tbody th {
            text-align: left;
            background: #f7f7f7;
            color: #3b3a3a;
            vertical-align: middle;
            text-align: center;
        }

        .board_detail tbody th, .board_detail tbody td {
            padding: 10px 15px;
            border-bottom: 1px solid #ccc;
        }

        .board_detail tbody textarea {
            width: 100%;
            min-height: 170px
        }

        .btn {
            margin: 5px;
            padding: 5px 11px;
            color: #fff !important;
            display: inline-block;
            background-color: #7D7F82;
            vertical-align: middle;
            border-radius: 0 !important;
            cursor: pointer;
            border: none;
        }

        .btn:hover {
            background: #6b9ab8;
        }

        .file_list a {
            display: inherit !important;
        }

        a {
            display: inline-block
        }

        #SE_contents {
            background-color: #e7f1ff;
        }

        /*  추가 css*/
        #user_info_bgc1 {
            margin-left: 2.5%;
            margin-top: 0;
            background-color: #DBE3FF;
            width: 95%;
            height: 70%;
            border-radius: 10px;
            position: relative;
        }

        #head_info {
            background-color: #f7f7f7;
        }

        #likes {
            margin-top: 20px;
            position: relative;
            left: 425px;
            text-align: center;
        }

        #reply {
            border-bottom: 2px solid #00008B;
        }

        #reply_comment {
            box-sizing: border-box;
        }

        #reply_reply_comment {
            background-color: #F0FFFF;
            border-top: 1px solid #D3D3D3;


        }

        #reply_reply_icon {
            transform: rotate(135deg);
        }


        #reply_reg {
            background-color: #F0FFFF;
            border-bottom: 2px solid #00008B;
            border-top: 2px solid #00008B;
        }

        #reply_reply_reg {
            background-color: #F0FFFF;
            border-top: 1px solid #D3D3D3;
        }

        #reply_list1 {
            margin-top: 10px;
            border: 3px solid #fffbfb;
            height: 800px;
            border-radius: 20px;
        }

        #frm_div {
            margin-top: 20px;
            border: 3px solid #fffbfb;
            padding: 10px;
            border-radius: 20px;

        }

        #list, #edit, #delete {
            position: relative;
            left: 900px;
        }

        #likes_btn1, #likes_btn2 {
            position: relative;
            left: 470px;
        }

        #tc, #cc {
            position: relative;
            top: 15px;

        }

        #reply_reply_reg_btn {

        }


    </style>
</head>
<body>
<div id="SE_container1">
    <th:block th:insert="/mainImg"></th:block>
    <div id="SE_topline">
        <!--검색과 로그인 + 왼쪽 사이드-->
        <th:block th:insert="/searchAndLogin"></th:block>
        <!--검색과 로그인 end-->
        <div id="SE_contents" style="z-index:2">
            <!--메뉴 + 오른쪽 사이드-->
            <th:block th:insert="/menuAndAside"></th:block>
            <!--메뉴 end-->
            <!--게시글 상세 화면 시작 -->
            <h2 style="text-align: center">게시글 상세 화면</h2>
            <div id="frm_div">
                <div id="frm">
                    <table>
                        <colgroup>
                            <col width="18%">
                            <col width="35%">
                            <col width="15%">
                            <col width="35%">
                        </colgroup>
                        <input id="galaxyNo" type="hidden" name="galaxyNo" th:value="${board.galaxyNo}">
                        <input id="boardNo" type="hidden" name="boardNo" th:value="${board.boardNo}">
                        <caption>게시글 상세 내용</caption>
                        <a href="#this" class="btn" id="list">목록으로</a>
                        <a class="btn" id="edit" href="javascript:void(0)" th:onclick="location.href=[[@{'/board/updateBoard/{boardNo}' (boardNo=${param.boardNo})}]]">수정</a>
                        <a href="#delete" class="btn" id="delete">삭제</a>
                        <tbody>
                        <tr>
                            <th scope="row">글 번호</th>
                            <td th:value="${board.boardNo}">
                                <th:block th:text="${board.boardNo}"></th:block>
                            <th scope="row">조회수</th>
                            <td th:text="${board.views}"></td>
                        </tr>
                        <tr>
                            <th scope="row">작성자</th>
                            <td th:text="${board.userId}"></td>
                            <th scope="row">작성일</th>
                            <td th:text="${board.postTime}"></td>
                        </tr>
                        <tr id="tc">
                            <th scope="row">제목</th>
                            <td colspan="3"><input type="text" id="title" name="title" th:value="${board.title}"/></td>
                        </tr>
                        <tr id="cc">
                            <th scope="row">내용</th>
                            <td colspan="4" class="view_text">
                                <textarea title="내용" id="contents" name="contents" th:text="${board.contents}"
                                          style="margin-top: 15px"></textarea>
                            </td>
                        </tr>
                        </tbody>

                    </table>
                    <!-- 좋아요/ 싫어요 버튼-->
                    <div id="likes">
                        <span id="uploadPreferContainer"
                              th:include="/boardPrefer" th:with="prefer=${board.boardPreferView}">
                        </span>

                    </div>
                    <!-- 좋아요/ 싫어요 버튼 end-->
                </div>
            </div> <!--frm_div-->
            <!--댓글-->
            <ul class="list-group">
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    A list item
                    <span class="badge bg-primary rounded-pill">14</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    A second list item
                    <span class="badge bg-primary rounded-pill">2</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    A third list item
                    <span class="badge bg-primary rounded-pill">1</span>
                </li>
            </ul>
            <!--댓글 end-->
            <!--전체 글 출력 -->
            <div class="accordion" id="accordionExample">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                            jj
                        </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne"
                         data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <strong>This is the first item's accordion body.</strong> It is shown by default, until the
                            collapse plugin adds the appropriate classes that we use to style each element. These
                            classes control the overall appearance, as well as the showing and hiding via CSS
                            transitions. You can modify any of this with custom CSS or overriding our default variables.
                            It's also worth noting that just about any HTML can go within the
                            <code>.accordion-body</code>, though the transition does limit overflow.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            Accordion Item #2
                        </button>
                    </h2>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo"
                         data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <strong>This is the second item's accordion body.</strong> It is hidden by default, until
                            the collapse plugin adds the appropriate classes that we use to style each element. These
                            classes control the overall appearance, as well as the showing and hiding via CSS
                            transitions. You can modify any of this with custom CSS or overriding our default variables.
                            It's also worth noting that just about any HTML can go within the
                            <code>.accordion-body</code>, though the transition does limit overflow.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingThree">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                            Accordion Item #3
                        </button>
                    </h2>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree"
                         data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <strong>This is the third item's accordion body.</strong> It is hidden by default, until the
                            collapse plugin adds the appropriate classes that we use to style each element. These
                            classes control the overall appearance, as well as the showing and hiding via CSS
                            transitions. You can modify any of this with custom CSS or overriding our default variables.
                            It's also worth noting that just about any HTML can go within the
                            <code>.accordion-body</code>, though the transition does limit overflow.
                        </div>
                    </div>
                </div>
            </div>
            <!--전체 글 출력  end-->


        </div> <!--SE_contents-->
    </div> <!--SE_topline-->
</div> <!--SE_container1-->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    const boardNo = document.getElementById("boardNo").value
    $(document).ready(function () {
        $('#list').on("click", function () {
            const galaxyNo = document.getElementById("galaxyNo").value;
            location.href = "/board/boardList.do?galaxyNo=" + Number(galaxyNo);
        });

        $('#edit').on("click", function () {
            var frm = $('#frm')[0];

            frm.action = "/board/updateBoard/"+boardNo;
            frm.submit();
        });

        $('#delete').on("click", function () {
            var frm = $('#frm')[0];
            location.href = "/board/deleteBoard?boardNo=" + Number(boardNo);
            frm.submit();
        });
    });
</script>
<script th:inline="javascript">
    async function boardPreferHandler(uploadNo,preferBtn){
        let url=`/board/prefer/handler.do?boardNo=${boardNo}&preferBtn=${preferBtn}`;
        let viewUrl=`/board/prefer/view.do?boardNo=`+boardNo;
        const boardPreferContainer=document.getElementById("boardPreferContainer");
        const resp=await fetch(url,{method:"PUT"});
        if(resp.status===200){
            const json=await resp.json();
            if(json.state===1){
                const resp=await fetch(viewUrl);
                if(resp.status===200){
                    let html=await resp.text();
                    boardPreferContainer.innerHTML=html;
                }else{
                    alert("좋아요 싫어요 불러오기 실패(새로고침하세요.)");
                }
            }else{
                alert("좋아요 싫어요 실패");
            }
        }else if(resp.status===400){
            alert("로그인 하셔야 이용할 수 있습니다.");
        }else if(resp.status===405){
            alert("잘못된 경로를 이용하고 있습니다.")
        }else if(resp.status===500){
            alert("데이터베이스 서버 오류")
        }

    }

</script>
</body>
</html>