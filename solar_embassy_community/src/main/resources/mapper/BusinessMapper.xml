<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.community.solar_embassy.mapper.BusinessMapper">

    <resultMap id="BaseResultMap" type="com.community.solar_embassy.dto.BusinessDto">
            <id property="licenseNum" column="licenseNum" jdbcType="VARCHAR"/>
            <id property="buTell" column="bu_tell" jdbcType="VARCHAR"/>
            <result property="buId" column="bu_id" jdbcType="VARCHAR"/>
            <result property="buPasswords" column="bu_passwords" jdbcType="VARCHAR"/>
            <result property="buName" column="bu_name" jdbcType="VARCHAR"/>
            <result property="email" column="email" jdbcType="VARCHAR"/>
            <result property="buTitle" column="bu_title" jdbcType="VARCHAR"/>
            <result property="buAddress" column="bu_address" jdbcType="VARCHAR"/>
            <result property="buCode" column="bu_code" jdbcType="INTEGER"/>
            <result property="crImgNo" column="cr_img_no" jdbcType="INTEGER"/>
            <result property="imgPath" column="img_path" jdbcType="VARCHAR"/>
            <result property="sourceImgName" column="source_img_name" jdbcType="VARCHAR"/>
            <result property="saveImgName" column="save_img_name" jdbcType="VARCHAR"/>
            <result property="regDate" column="reg_date" jdbcType="TIMESTAMP"/>
            <result property="updateTime" column="update_time" jdbcType="TIMESTAMP"/>
    </resultMap>

<!--    <sql id="Base_Column_List">-->
<!--        cr_num,bu_tell,bu_id,-->
<!--        bu_passwords,bu_name,email,-->
<!--        bu_title,bu_address,bu_code,-->
<!--        cr_img_no,img_path,source_img_name,-->
<!--        save_img_name,reg_date,update_time-->
<!--    </sql>-->

<!--    아이디 중복 확인 -->
    <select id="getId" parameterType="com.community.solar_embassy.dto.BusinessDto" resultType="java.lang.Integer">
        SELECT IFNULL(COUNT(*),0) FROM business
        WHERE buId = #{buId}
    </select>
<!--    회원가입 -->
    <insert id="addBusiness" parameterType="com.community.solar_embassy.dto.BusinessDto" useGeneratedKeys="true" keyProperty="buNo" keyColumn="buNo">
        INSERT INTO business(buId, buPasswords, buName, email, phone, regDate, updateTime, state, auth)
        VALUE(#{buId}, #{buPasswords}, #{buName}, #{email}, #{phone}, NOW(), #{updateTime}, 0, 1)
        <!-- state(상태) 0 : 정상 이용 가능 1: 정지 계정  2: 회원탈퇴 -->
    </insert>

<!-- 로그인-->
    <select id="login" parameterType="com.community.solar_embassy.dto.BusinessDto" resultType="com.community.solar_embassy.dto.BusinessDto">
        SELECT * FROM business
        WHERE buId = #{buId} AND buPasswords = #{buPasswords}

    </select>



</mapper>
